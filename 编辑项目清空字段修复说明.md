# ç¼–è¾‘é¡¹ç›®æ¸…ç©ºå­—æ®µä¿®å¤è¯´æ˜

## ä¿®å¤æ—¶é—´
2025å¹´11æœˆ4æ—¥

## é—®é¢˜æè¿°
åœ¨ç¼–è¾‘é¡¹ç›®æ—¶ï¼Œå°†æ—¥æœŸå­—æ®µï¼ˆå¼€å§‹æ—¥æœŸ/é¢„è®¡å®Œæˆæ—¥æœŸï¼‰æ¸…ç©ºå¹¶ä¿å­˜åï¼Œå†æ¬¡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†æ—¶ï¼Œå‘ç°æ—¥æœŸä»ç„¶æ˜¯åŸæ¥çš„å€¼ï¼Œæ²¡æœ‰è¢«æ¸…ç©ºã€‚

---

## é—®é¢˜åŸå› åˆ†æ

### åŸæœ‰çš„åç«¯é€»è¾‘ âŒ
```python
if 'start_date' in project_data and project_data['start_date']:
    project.start_date = datetime.strptime(project_data['start_date'], '%Y-%m-%d').date()

if 'end_date' in project_data and project_data['end_date']:
    project.end_date = datetime.strptime(project_data['end_date'], '%Y-%m-%d').date()
```

**é—®é¢˜**ï¼š
- åªæœ‰å½“æ—¥æœŸå­—æ®µ**æœ‰å€¼**æ—¶æ‰ä¼šæ›´æ–°
- å½“å‰ç«¯ä¼  `null` æˆ–ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œåç«¯ä¸åšä»»ä½•å¤„ç†
- å¯¼è‡´æ•°æ®åº“ä¸­çš„æ—§å€¼è¢«ä¿ç•™

### ç”¨æˆ·æ“ä½œæµç¨‹
```
1. åˆ›å»ºé¡¹ç›®
   å¼€å§‹æ—¥æœŸ: 2025-01-01
   ç»“æŸæ—¥æœŸ: 2025-12-31
   â†’ ä¿å­˜æˆåŠŸ âœ…

2. ç¼–è¾‘é¡¹ç›®ï¼Œæ¸…ç©ºæ—¥æœŸ
   å¼€å§‹æ—¥æœŸ: [æ¸…ç©º]
   ç»“æŸæ—¥æœŸ: [æ¸…ç©º]
   â†’ å‰ç«¯å‘é€: { start_date: null, end_date: null }
   â†’ åç«¯çœ‹åˆ°æ˜¯ nullï¼Œä¸æ›´æ–° âŒ
   â†’ æ•°æ®åº“ä¸­è¿˜æ˜¯: 2025-01-01 å’Œ 2025-12-31

3. å†æ¬¡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
   â†’ ä»æ•°æ®åº“è¯»å–: 2025-01-01 å’Œ 2025-12-31
   â†’ ç”¨æˆ·çœ‹åˆ°æ—¥æœŸè¿˜åœ¨ ğŸ˜±
```

---

## ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤åçš„é€»è¾‘ âœ…

#### æ—¥æœŸå­—æ®µå¤„ç†
```python
if 'start_date' in project_data:
    # å¦‚æœæ—¥æœŸä¸ºç©ºï¼ˆNone, null, ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œåˆ™æ¸…ç©ºæ—¥æœŸ
    if project_data['start_date']:
        project.start_date = datetime.strptime(project_data['start_date'], '%Y-%m-%d').date()
    else:
        project.start_date = None  # â† æ˜¾å¼è®¾ç½®ä¸º None

if 'end_date' in project_data:
    # å¦‚æœæ—¥æœŸä¸ºç©ºï¼ˆNone, null, ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œåˆ™æ¸…ç©ºæ—¥æœŸ
    if project_data['end_date']:
        project.end_date = datetime.strptime(project_data['end_date'], '%Y-%m-%d').date()
    else:
        project.end_date = None  # â† æ˜¾å¼è®¾ç½®ä¸º None
```

#### åˆä½œæ–¹å­—æ®µå¤„ç†ï¼ˆä¸€å¹¶ä¼˜åŒ–ï¼‰
```python
if 'partner' in project_data:
    # åˆä½œæ–¹å¯ä»¥ä¸ºç©ºå­—ç¬¦ä¸²æˆ–None
    project.partner = project_data['partner'] if project_data['partner'] else None
```

---

## ä¿®å¤å‰åå¯¹æ¯”

### ä¿®å¤å‰ âŒ
| æ“ä½œ | å‰ç«¯å‘é€ | åç«¯å¤„ç† | æ•°æ®åº“ | ç»“æœ |
|------|---------|---------|--------|------|
| æ¸…ç©ºå¼€å§‹æ—¥æœŸ | `{ start_date: null }` | ä¸å¤„ç† | `2025-01-01` | âŒ æœªæ¸…ç©º |
| æ¸…ç©ºç»“æŸæ—¥æœŸ | `{ end_date: null }` | ä¸å¤„ç† | `2025-12-31` | âŒ æœªæ¸…ç©º |
| è®¾ç½®æ—¥æœŸ | `{ start_date: '2025-02-01' }` | æ›´æ–° | `2025-02-01` | âœ… æ­£å¸¸ |

### ä¿®å¤å âœ…
| æ“ä½œ | å‰ç«¯å‘é€ | åç«¯å¤„ç† | æ•°æ®åº“ | ç»“æœ |
|------|---------|---------|--------|------|
| æ¸…ç©ºå¼€å§‹æ—¥æœŸ | `{ start_date: null }` | è®¾ç½®ä¸º `None` | `NULL` | âœ… å·²æ¸…ç©º |
| æ¸…ç©ºç»“æŸæ—¥æœŸ | `{ end_date: null }` | è®¾ç½®ä¸º `None` | `NULL` | âœ… å·²æ¸…ç©º |
| è®¾ç½®æ—¥æœŸ | `{ start_date: '2025-02-01' }` | æ›´æ–° | `2025-02-01` | âœ… æ­£å¸¸ |

---

## ä¿®å¤å†…å®¹è¯¦æƒ…

### 1. å¼€å§‹æ—¥æœŸå­—æ®µ
```python
# ä¿®å¤å‰
if 'start_date' in project_data and project_data['start_date']:
    project.start_date = datetime.strptime(project_data['start_date'], '%Y-%m-%d').date()

# ä¿®å¤å
if 'start_date' in project_data:
    if project_data['start_date']:
        project.start_date = datetime.strptime(project_data['start_date'], '%Y-%m-%d').date()
    else:
        project.start_date = None  # æ˜¾å¼æ¸…ç©º
```

### 2. é¢„è®¡å®Œæˆæ—¥æœŸå­—æ®µ
```python
# ä¿®å¤å‰
if 'end_date' in project_data and project_data['end_date']:
    project.end_date = datetime.strptime(project_data['end_date'], '%Y-%m-%d').date()

# ä¿®å¤å
if 'end_date' in project_data:
    if project_data['end_date']:
        project.end_date = datetime.strptime(project_data['end_date'], '%Y-%m-%d').date()
    else:
        project.end_date = None  # æ˜¾å¼æ¸…ç©º
```

### 3. åˆä½œæ–¹å­—æ®µï¼ˆä¸€å¹¶ä¼˜åŒ–ï¼‰
```python
# ä¿®å¤å‰
if 'partner' in project_data:
    project.partner = project_data['partner']

# ä¿®å¤å
if 'partner' in project_data:
    project.partner = project_data['partner'] if project_data['partner'] else None
```

---

## å¤„ç†é€»è¾‘è¯´æ˜

### ä¸‰ç§æƒ…å†µçš„å¤„ç†

#### æƒ…å†µ1ï¼šè®¾ç½®æ—¥æœŸå€¼
```python
å‰ç«¯: { start_date: '2025-01-01' }
åç«¯: project.start_date = datetime(2025, 1, 1)
æ•°æ®åº“: 2025-01-01
ç»“æœ: âœ… æ­£å¸¸è®¾ç½®
```

#### æƒ…å†µ2ï¼šæ¸…ç©ºæ—¥æœŸï¼ˆnullï¼‰
```python
å‰ç«¯: { start_date: null }
åç«¯: project.start_date = None
æ•°æ®åº“: NULL
ç»“æœ: âœ… æ­£ç¡®æ¸…ç©º
```

#### æƒ…å†µ3ï¼šæ¸…ç©ºæ—¥æœŸï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰
```python
å‰ç«¯: { start_date: '' }
åç«¯: project.start_date = None
æ•°æ®åº“: NULL
ç»“æœ: âœ… æ­£ç¡®æ¸…ç©º
```

#### æƒ…å†µ4ï¼šä¸æäº¤è¯¥å­—æ®µ
```python
å‰ç«¯: { name: 'æ–°é¡¹ç›®å' }  # ä¸åŒ…å« start_date
åç«¯: ä¸å¤„ç† start_date
æ•°æ®åº“: ä¿æŒåŸå€¼
ç»“æœ: âœ… ç¬¦åˆé¢„æœŸ
```

---

## æµ‹è¯•éªŒè¯

### æµ‹è¯•åœºæ™¯1ï¼šæ¸…ç©ºå¼€å§‹æ—¥æœŸ
1. ç¼–è¾‘ä¸€ä¸ªæœ‰å¼€å§‹æ—¥æœŸçš„é¡¹ç›®ï¼ˆå¦‚ï¼š2025-01-01ï¼‰
2. æ¸…ç©ºå¼€å§‹æ—¥æœŸå­—æ®µ
3. ä¿å­˜
4. å†æ¬¡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
5. **é¢„æœŸ**ï¼šå¼€å§‹æ—¥æœŸåº”è¯¥ä¸ºç©º âœ…

### æµ‹è¯•åœºæ™¯2ï¼šæ¸…ç©ºç»“æŸæ—¥æœŸ
1. ç¼–è¾‘ä¸€ä¸ªæœ‰ç»“æŸæ—¥æœŸçš„é¡¹ç›®ï¼ˆå¦‚ï¼š2025-12-31ï¼‰
2. æ¸…ç©ºç»“æŸæ—¥æœŸå­—æ®µ
3. ä¿å­˜
4. å†æ¬¡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
5. **é¢„æœŸ**ï¼šç»“æŸæ—¥æœŸåº”è¯¥ä¸ºç©º âœ…

### æµ‹è¯•åœºæ™¯3ï¼šæ¸…ç©ºä¸€ä¸ªä¿ç•™ä¸€ä¸ª
1. é¡¹ç›®åŸæœ‰ï¼šå¼€å§‹æ—¥æœŸ 2025-01-01ï¼Œç»“æŸæ—¥æœŸ 2025-12-31
2. æ¸…ç©ºå¼€å§‹æ—¥æœŸï¼Œä¿ç•™ç»“æŸæ—¥æœŸ
3. ä¿å­˜
4. å†æ¬¡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
5. **é¢„æœŸ**ï¼šå¼€å§‹æ—¥æœŸä¸ºç©ºï¼Œç»“æŸæ—¥æœŸä¸º 2025-12-31 âœ…

### æµ‹è¯•åœºæ™¯4ï¼šä»ç©ºè®¾ç½®å€¼
1. é¡¹ç›®åŸæœ¬æ²¡æœ‰æ—¥æœŸ
2. è®¾ç½®å¼€å§‹æ—¥æœŸä¸º 2025-01-01
3. ä¿å­˜
4. å†æ¬¡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
5. **é¢„æœŸ**ï¼šå¼€å§‹æ—¥æœŸæ˜¾ç¤º 2025-01-01 âœ…

### æµ‹è¯•åœºæ™¯5ï¼šä¿®æ”¹æ—¥æœŸå€¼
1. é¡¹ç›®åŸæœ‰å¼€å§‹æ—¥æœŸ 2025-01-01
2. ä¿®æ”¹ä¸º 2025-02-01
3. ä¿å­˜
4. å†æ¬¡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
5. **é¢„æœŸ**ï¼šå¼€å§‹æ—¥æœŸæ˜¾ç¤º 2025-02-01 âœ…

### æµ‹è¯•åœºæ™¯6ï¼šæ¸…ç©ºåˆä½œæ–¹
1. é¡¹ç›®åŸæœ‰åˆä½œæ–¹"æŸå…¬å¸"
2. æ¸…ç©ºåˆä½œæ–¹å­—æ®µ
3. ä¿å­˜
4. å†æ¬¡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
5. **é¢„æœŸ**ï¼šåˆä½œæ–¹åº”è¯¥ä¸ºç©º âœ…

---

## æ•°æ®åº“å½±å“

### å­—æ®µå¯ç©ºæ€§
è¿™äº›å­—æ®µåœ¨æ•°æ®åº“ä¸­åº”è¯¥å…è®¸ä¸º `NULL`ï¼š
- âœ… `start_date` - å¯ä»¥ä¸º NULL
- âœ… `end_date` - å¯ä»¥ä¸º NULL
- âœ… `partner` - å¯ä»¥ä¸º NULL
- âœ… `contract_amount` - å¯ä»¥ä¸º NULL
- âœ… `received_amount` - å¯ä»¥ä¸º NULL

### æ•°æ®ä¸€è‡´æ€§
```sql
-- æ¸…ç©ºåçš„æ•°æ®åº“è®°å½•
SELECT id, name, start_date, end_date 
FROM projects 
WHERE id = 1;

-- é¢„æœŸç»“æœ
| id | name      | start_date | end_date |
|----|-----------|------------|----------|
| 1  | æµ‹è¯•é¡¹ç›®   | NULL       | NULL     |
```

---

## ç›¸å…³æ–‡ä»¶

### ä¿®æ”¹çš„æ–‡ä»¶
- âœ… `backend/services/project_service.py`

### ä¿®æ”¹ä½ç½®
```240:252:backend/services/project_service.py
if 'start_date' in project_data:
    # å¦‚æœæ—¥æœŸä¸ºç©ºï¼ˆNone, null, ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œåˆ™æ¸…ç©ºæ—¥æœŸ
    if project_data['start_date']:
        project.start_date = datetime.strptime(project_data['start_date'], '%Y-%m-%d').date()
    else:
        project.start_date = None

if 'end_date' in project_data:
    # å¦‚æœæ—¥æœŸä¸ºç©ºï¼ˆNone, null, ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œåˆ™æ¸…ç©ºæ—¥æœŸ
    if project_data['end_date']:
        project.end_date = datetime.strptime(project_data['end_date'], '%Y-%m-%d').date()
    else:
        project.end_date = None
```

---

## æŠ€æœ¯è¦ç‚¹

### Python ä¸­çš„"å‡å€¼"åˆ¤æ–­
```python
# ä»¥ä¸‹å€¼åœ¨ if åˆ¤æ–­ä¸­éƒ½ä¸º Falseï¼š
- None
- False
- 0
- '' (ç©ºå­—ç¬¦ä¸²)
- [] (ç©ºåˆ—è¡¨)
- {} (ç©ºå­—å…¸)

# æˆ‘ä»¬çš„ä»£ç åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼š
if project_data['start_date']:  # None å’Œ '' éƒ½ä¼šèµ° else åˆ†æ”¯
    # æœ‰å€¼ï¼Œè§£ææ—¥æœŸ
else:
    # æ— å€¼ï¼Œæ¸…ç©º
```

### æ•°æ®åº“ NULL vs ç©ºå­—ç¬¦ä¸²
```
æ•°æ®åº“ NULL:   è¡¨ç¤º"æœªè®¾ç½®"ã€"ä¸çŸ¥é“"
ç©ºå­—ç¬¦ä¸² '':    è¡¨ç¤º"å·²è®¾ç½®ä¸ºç©º"

åœ¨æ—¥æœŸå­—æ®µä¸­ï¼Œæˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨ NULL è¡¨ç¤ºæœªè®¾ç½®
```

---

## æ€»ç»“

### é—®é¢˜æœ¬è´¨
åç«¯æ›´æ–°é€»è¾‘åªå¤„ç†"æœ‰å€¼"çš„æƒ…å†µï¼Œå¿½ç•¥äº†"æ¸…ç©º"çš„éœ€æ±‚ã€‚

### è§£å†³æ–¹æ¡ˆ
- åŒºåˆ†"æœ‰å€¼"å’Œ"æ— å€¼"ä¸¤ç§æƒ…å†µ
- "æ— å€¼"æ—¶æ˜¾å¼è®¾ç½®ä¸º `None`ï¼ˆæ•°æ®åº“ `NULL`ï¼‰

### å½±å“èŒƒå›´
- âœ… å¼€å§‹æ—¥æœŸå¯ä»¥æ­£ç¡®æ¸…ç©º
- âœ… é¢„è®¡å®Œæˆæ—¥æœŸå¯ä»¥æ­£ç¡®æ¸…ç©º
- âœ… åˆä½œæ–¹å¯ä»¥æ­£ç¡®æ¸…ç©º
- âœ… ä¸å½±å“å…¶ä»–å­—æ®µçš„æ›´æ–°é€»è¾‘
- âœ… ä¸å½±å“ç°æœ‰é¡¹ç›®æ•°æ®

### ç”¨æˆ·ä½“éªŒæå‡
- âœ… æ¸…ç©ºæ“ä½œç¬¦åˆç”¨æˆ·é¢„æœŸ
- âœ… æ•°æ®æ›´æ–°ç«‹å³ç”Ÿæ•ˆ
- âœ… æé«˜äº†ç³»ç»Ÿçš„å¯æ§æ€§

---

*ä¿®å¤å®Œæˆäº 2025å¹´11æœˆ4æ—¥*

