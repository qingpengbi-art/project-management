# 项目金额字段添加说明

## 修改概述
为项目管理系统添加了"项目金额"字段，该字段为非必填项，可在新建项目和编辑项目时输入。

## 修改内容

### 1. 数据库迁移
**文件**: `backend/migrate_add_amount.py`

- 创建了数据库迁移脚本
- 为 `projects` 表添加 `amount` 字段（REAL类型，允许NULL）
- 迁移已成功执行 ✓

### 2. 数据库模型
**文件**: `backend/models/database.py`

**修改内容**:
- 在 `Project` 模型中添加了 `amount` 字段定义：
  ```python
  amount = db.Column(db.Float, nullable=True)  # 项目金额（非必填）
  ```
- 在 `to_dict()` 方法中添加了 `amount` 字段的序列化

### 3. 项目服务层
**文件**: `backend/services/project_service.py`

**修改内容**:
- 在 `create_project()` 方法中添加了 `amount` 字段的创建逻辑
- 在 `update_project()` 方法中添加了 `amount` 字段的更新逻辑

### 4. 前端 - 创建项目对话框
**文件**: `frontend/src/components/CreateProjectDialog.vue`

**修改内容**:
- 添加了金额输入框，带有人民币符号前缀
- 输入类型为数字，支持小数点后两位
- 添加到表单数据中，初始值为 `null`
- 在重置表单时正确处理 `amount` 字段

### 5. 前端 - 编辑项目对话框
**文件**: `frontend/src/components/EditProjectDialog.vue`

**修改内容**:
- 添加了金额输入框，带有人民币符号前缀
- 输入类型为数字，支持小数点后两位
- 在表单数据中添加 `amount` 字段
- 在编辑模式下正确加载现有的金额数据
- 在重置表单时正确处理 `amount` 字段

## 字段特性

- **字段名称**: amount
- **字段类型**: Float（浮点数）
- **是否必填**: 否（nullable=True）
- **前端展示**: 带有"¥"前缀的数字输入框
- **输入限制**: 
  - 最小值: 0
  - 步进值: 0.01（支持分）
  - 数字类型（自动转换）

## 使用说明

### 创建项目时
1. 在创建项目对话框中，找到"项目金额"字段
2. 输入项目金额（可选）
3. 金额会以浮点数形式保存到数据库

### 编辑项目时
1. 在编辑项目对话框中，可以看到现有的项目金额
2. 可以修改金额或清空金额
3. 保存后会更新数据库中的金额信息

### 注意事项
- 金额字段为可选项，不填写不影响项目创建和编辑
- 金额支持小数点后两位，适合精确到分
- 前端显示带有人民币符号，但数据库中仅保存数值

## 测试建议

1. **创建项目测试**
   - 创建项目时不填写金额
   - 创建项目时填写整数金额
   - 创建项目时填写带小数的金额

2. **编辑项目测试**
   - 编辑已有金额的项目
   - 编辑没有金额的项目并添加金额
   - 编辑已有金额的项目并清空金额

3. **数据验证**
   - 验证金额正确保存到数据库
   - 验证金额正确显示在项目详情中
   - 验证金额在项目列表中正确展示（如需要）

## 完成状态
✅ 所有修改已完成
✅ 数据库迁移已成功执行
✅ 无语法错误
✅ 符合DDD分层架构设计原则


